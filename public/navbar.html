<nav>
  <ul>
    <li><a href="/profile.html" class="nav-item" id="nav-home">Home</a></li>
    <li><a href="/profile.html">Profile</a></li>
    <li><a href="/lobby.html">Lobby</a></li>
    <li><a href="/player.html">My Stats</a></li>
    <li><a href="/profile-settings.html">Profile Settings</a></li>
    <li><a href="/about.html">About</a></li>
    <li><a href="https://discord.gg/8m4xG8sjXm" target="_blank">Discord</a></li>
    <li class="right-nav">
      <div class="nav-player-name">
        <img id="navbarProfile" src="/img/fallback-pfp.png" alt="Avatar">
        <span id="navbarUsername">Player Name</span>
        <span id="navbarElo" class="elo-display">ELO: 0</span>
      </div>
    </li>
  </ul>
</nav>

<script>
  async function initNavbar() {
    try {
      const res = await fetch('/user/info');
      if (!res.ok) {
        // User not logged in - change Home to root
        document.getElementById('nav-home').href = '/';
        return;
      }
      
      const user = await res.json();
      document.getElementById('navbarUsername').textContent = user.username;
      document.getElementById('navbarProfile').src = user.profilePictureUrl;
      
      // Update Home link to go to profile page
      document.getElementById('nav-home').href = '/profile.html';

      const eloRes = await fetch('/user/skill');
      if (eloRes.ok) {
        const eloData = await eloRes.json();
        document.getElementById('navbarElo').textContent = `ELO: ${eloData.skill || 0}`;
      }
    } catch (error) {
      console.error('Navbar init error:', error);
      // Keep default Home link on error
      document.getElementById('nav-home').href = '/';
    }
  }
  
  document.addEventListener('DOMContentLoaded', initNavbar);
</script>
