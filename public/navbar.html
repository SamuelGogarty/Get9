<nav>
  <ul>
    <li><a href="/profile.html" class="nav-item" id="nav-home">Home</a></li>
    <li><a href="/lobby.html" class="nav-item">Lobby</a></li>
    <li><a href="/player.html" class="nav-item">My Stats</a></li>
    <li><a href="https://discord.gg/8m4xG8sjXm" class="nav-item" target="_blank">Discord</a></li>
    <li><a href="/profile-settings.html" class="nav-item">Profile Settings</a></li>
    <li><a href="/about.html" class="nav-item">About</a></li>
    <li><a href="/contact.html" class="nav-item">Contact</a></li>
    <li><a href="/store.html" class="nav-item">Store</a></li>
    <li><a href="/forums.html" class="nav-item">Forums</a></li>
    <li class="right-nav">
      <div class="nav-player-name">
        <img id="navbarProfile" src="/img/fallback-pfp.png" alt="Avatar">
        <span id="navbarUsername">Player Name</span>
        <span id="navbarElo" class="elo-display">ELO: 0</span>
      </div>
    </li>
  </ul>
</nav>

<script>
  async function initNavbar() {
    try {
      const res = await fetch('/user/info');
      if (!res.ok) {
        // User not logged in - change Home to root
        document.getElementById('nav-home').href = '/';
        return;
      }
      
      const user = await res.json();
      document.getElementById('navbarUsername').textContent = user.username;
      
      // Set profile picture with error fallback
      const profileImg = document.getElementById('navbarProfile');
      profileImg.src = user.profilePictureUrl || '/img/fallback-pfp.png';
      profileImg.onerror = function() {
        this.src = '/img/fallback-pfp.png';
      };
      
      // Update Home link to go to profile page
      document.getElementById('nav-home').href = '/profile.html';

      // Fetch ELO rating
      const eloRes = await fetch('/user/skill');
      if (eloRes.ok) {
        const eloData = await eloRes.json();
        document.getElementById('navbarElo').textContent = `ELO: ${eloData.skill || 0}`;
      }
    } catch (error) {
      console.error('Navbar init error:', error);
      // Keep default Home link on error
      document.getElementById('nav-home').href = '/';
    }
  }
  
  // Initialize immediately on script load
  initNavbar();
</script>
